<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css"/>
    <link rel="stylesheet" href="../static/css/base.css">
    <link rel="stylesheet" href="../static/css/question.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+And+White+Picture&display=swap" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
    <title>ì§ˆë¬¸</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function(){
            $('#like-button').click(function(){
                $.ajax({
                    url: "{{ url_for('increment_like') }}",
                    type: "POST",
                    success: function(response) {
                        if (response.like_count !== undefined) {
                            $('#like-count').text(response.like_count);
                        }
                    },
                    error: function(error) {
                        console.log("Error:", error);
                    }
                });
            });

            $('.question').click(function(){
                $.ajax({
                    url: "{{ url_for('increment_click') }}",
                    type: "POST",
                    success: function(response) {
                        if (response.click_count !== undefined) {
                            $('#click-count').text(response.click_count);
                        }
                    },
                    error: function(error) {
                        console.log("Error:", error);
                    }
                });
            });
        });
    </script>
</head>
<body>

<!-- í—¤ë” -->
<header>
    <nav id="top-nav" role="navigation" class="is-white">
        <div class="nav-logo">
            <a class="navbar-item" href="/">
                <img src="{{ url_for('static', filename='image/kaist_sw-logo.png') }}">
            </a>
        </div>
        <div class="nav-main">
            <div class="field is-grouped">
                {% if session.get('token') %}
                    <form action="{{ url_for('logout') }}" method="post" style="margin-right: 10px;">
                        <button class="button">ë¡œê·¸ì•„ì›ƒ</button>
                    </form>
                    <a class="button" href="{{ url_for('mypage') }}">ë§ˆì´ í˜ì´ì§€</a>
                {% else %}
                    <a class="button" href="{{ url_for('login') }}">ë¡œê·¸ì¸</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <section class="hero is-success">
        <div class="hero-body center">
            <p class="title">ì •ê¸€ ë°¸ëŸ°ìŠ¤ ê²Œì„</p>
            <p class="subtitle is-6">ë‚˜ë§Œì˜ ì •ê¸€ ë¦¬ì¶”ì–¼ ë§Œë“¤ê¸°</p>
        </div>
    </section>
</header>

<section class="question-info">
    <div class="question-maker-info">
        <span class="tag is-link is-light">{{ member['nickname'] }}</span>
        <span class="created-at">{{ question['created_at'] }}</span>
    </div>
    <div class="question-indicator">
        <button id="like-button" class="like-button" style="border: none; background: none; cursor: pointer;">
            ğŸ‘<span id="like-count">{{ like_count }}</span>
        </button>
        <span>ğŸ’¬<span id="comment-count">{{ comments|length }}</span></span>
        <span>ğŸ–±ï¸<span id="click-count">{{ click_count }}</span></span>
    </div>
</section>
<section class="question-box lr-align">
    <div class="button-box question-select">
        <button class="button question">{{ question['question1'] }}</button>
    </div>
    <div class="versus">
        <span class="versus-v">V</span>
        <span class="versus-s">S</span>
    </div>
    <div class="button-box">
        <button class="button question">{{ question['question2'] }}</button>
    </div>
</section>

<!-- ëŒ“ê¸€ ê°œìˆ˜ë¥¼ í‘œì‹œí•˜ëŠ” ë¶€ë¶„ -->
<section class="comments-section">
    <div class="comments-header">
        <span>ëŒ“ê¸€ {{ comments|length }}ê°œ</span>
    </div>
</section>

<section class="comment-input">
    <form action="{{ url_for('add_comment') }}" method="post">
        <textarea class="textarea is-success" rows="3" name="comment" placeholder="ëŒ“ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>
        <div class="button-right-align">
            <button class="button is-success is-light" type="submit">ëŒ“ê¸€ ë“±ë¡</button>
        </div>
    </form>
</section>
<section>
    {% for comment in comments %}
    <div class="comment-box">
        <div class="comment-nickname">
            <span class="tag is-link is-light">{{ comment.nickname }}</span>
            <p class="created-at">{{ comment.created_at }}</p>
        </div>
        <div class="comment-text">
            <p>{{ comment.text }}</p>
        </div>
    </div>
    {% endfor %}
</section>
</body>
</html>
